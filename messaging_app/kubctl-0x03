#!/bin/bash

set -e

echo "ğŸ“¦ Applying updated blue deployment (v2.0)..."
kubectl apply -f blue_deployment.yaml

echo "â³ Monitoring rollout status..."
kubectl rollout status deployment/django-blue

echo "ğŸ”„ Sending test requests using curl..."
for i in {1..10}; do
  curl -s http://127.0.0.1:PORT/ || echo "âŒ Request failed"
  sleep 1
done

echo "âœ… Verifying running pods:"
kubectl get pods -l app=django
